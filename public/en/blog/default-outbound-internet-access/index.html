<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage"><head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="icon" href="/favicon.svg">

  <title>
  Default Outbound Internet Access - Andy Cliftons Blog
  </title>
  <meta name="description" content="Default Outbound Internet Access niet langer by default allowed." />
  <meta name="author" content="Andy Clifton" />
  <meta name="generator" content="Hugo 0.148.2"><link
    rel="stylesheet"
    href="/css/styles.min.5d6fc9d4c39d720ef024bef64b70a099b88b309fd583b6c7ea32f1592512becc.css"
    integrity="sha256-XW/J1MOdcg7wJL72S3CgmbiLMJ/Vg7bH6jLxWSUSvsw="
  />
  
  

  <meta property="og:url" content="/en/blog/default-outbound-internet-access/">
  <meta property="og:site_name" content="Andy Cliftons Blog">
  <meta property="og:title" content="Default Outbound Internet Access">
  <meta property="og:description" content="Default Outbound Internet Access niet langer by default allowed.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2025-08-13T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-08-13T00:00:00+00:00">
    <meta property="article:tag" content="Networking">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Default Outbound Internet Access">
  <meta name="twitter:description" content="Default Outbound Internet Access niet langer by default allowed.">

  
  <meta itemprop="name" content="Default Outbound Internet Access">
  <meta itemprop="description" content="Default Outbound Internet Access niet langer by default allowed.">
  <meta itemprop="datePublished" content="2025-08-13T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-08-13T00:00:00+00:00">
  <meta itemprop="wordCount" content="1877">
  <meta itemprop="keywords" content="Networking">

  
</head>
<body class="dark:bg-gray-800 dark:text-white relative flex flex-col min-h-screen"><header class="container flex justify-between md:justify-between gap-4 flex-wrap p-6 mx-auto relative">
  <a href="/en/" class="capitalize font-extrabold text-2xl">
    
    <img src="/raw.png" alt="Andy Cliftons Blog" class="h-8 max-w-full" />
    
  </a>
  <button class="mobile-menu-button md:hidden">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <line x1="4" y1="8" x2="20" y2="8" />
      <line x1="4" y1="16" x2="20" y2="16" />
    </svg>
  </button>
  <ul class="mobile-menu absolute z-10 px-6 pb-6 md:p-0 top-full left-0 w-full md:w-auto md:relative hidden md:flex flex-col md:flex-row items-end md:items-center gap-4 lg:gap-6 bg-white dark:bg-gray-800">

    
    <li><a href="/en/blog">Blogs</a></li>
    
    <li><a href="/en/page/about/">Over Mij</a></li>
    

    

    
    <li class="grid place-items-center">
      <span class="open-search inline-block cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <circle cx="10" cy="10" r="7" />
          <line x1="21" y1="21" x2="15" y2="15" />
        </svg>
      </span>
    </li>
    

    
    <li class="grid place-items-center">
      <span class="toggle-dark-mode inline-block cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <circle cx="12" cy="12" r="3" />
          <line x1="12" y1="5" x2="12" y2="5.01" />
          <line x1="17" y1="7" x2="17" y2="7.01" />
          <line x1="19" y1="12" x2="19" y2="12.01" />
          <line x1="17" y1="17" x2="17" y2="17.01" />
          <line x1="12" y1="19" x2="12" y2="19.01" />
          <line x1="7" y1="17" x2="7" y2="17.01" />
          <line x1="5" y1="12" x2="5" y2="12.01" />
          <line x1="7" y1="7" x2="7" y2="7.01" />
        </svg>
      </span>
    </li>
    
  </ul>
</header>
<main class="flex-1">
  
  

  
  <div class="relative max-w-5xl mx-auto px-4">
    <img src="/img/outbound.jpeg" class="rounded-lg shadow-sm w-full object-contain" />
    
    <div class="absolute top-4 right-8 rounded shadow bg-white text-gray-900 dark:bg-gray-900 dark:text-white px-2 py-0.5">
      August 13, 2025
    </div>
    
  </div>
  

  <article class="prose lg:prose-lg mx-auto my-8 dark:prose-dark px-4">

    <h1 class="text-2xl font-bold mb-2">Default Outbound Internet Access</h1>
    
    <h5 class="text-sm flex items-center flex-wrap">
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <rect x="4" y="5" width="16" height="16" rx="2" />
        <line x1="16" y1="3" x2="16" y2="7" />
        <line x1="8" y1="3" x2="8" y2="7" />
        <line x1="4" y1="11" x2="20" y2="11" />
        <rect x="8" y="15" width="2" height="2" />
      </svg>
      Posted on August 13, 2025
      
        &nbsp;&bull;&nbsp;
      
      <svg xmlns="http://www.w3.org/2000/svg" class="mr-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <circle cx="12" cy="12" r="9" />
        <polyline points="12 7 12 12 15 15" />
      </svg>
      9¬†minutes
      &nbsp;&bull;
      <svg xmlns="http://www.w3.org/2000/svg" class="mx-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <path d="M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <path d="M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
        <line x1="3" y1="6" x2="3" y2="19" />
        <line x1="12" y1="6" x2="12" y2="19" />
        <line x1="21" y1="6" x2="21" y2="19" />
      </svg>
      1877¬†words
      
        
      
    </h5>
    

    <details id="TableOfContents" class="px-4 mt-4 bg-gray-100 dark:bg-gray-700 rounded toc">
    <summary class="flex items-center font-bold py-2 px-4 cursor-pointer justify-between select-none text-black dark:text-white">
      <span>Table of contents</span>
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-down" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <polyline points="6 9 12 15 18 9"></polyline>
     </svg>
    </summary>

    <ul class="mt-2 pb-4">
        

        
        <li>
        <a href="#default-outbound-internet-access-wordt-uitgeschakeld">Default Outbound Internet Access wordt uitgeschakeld</a>
        

        
        <ul>
            <ul>
            <li>
        <a href="#-disclaimer-work-in-progress-">==&gt; Disclaimer work in progress. &lt;==</a>
        

        
        </li></ul>
          <li>
        <a href="#voorwoord">Voorwoord</a>
        

        
        </li><li>
        <a href="#welke-oplossingen-zijn-er-om-dit-dan-goed-te-regelen">Welke oplossingen zijn er om dit dan goed te regelen.</a>
        

        
        </li><li>
        <a href="#hoe-kunen-we-checken-welke-machines-afhankelijk-zijn-van-outbound-access">Hoe kunen we checken welke machines afhankelijk zijn van Outbound access</a>
        

        
        </li><li>
        <a href="#aanmaken-van-een-azure-nat-gateway">Aanmaken van een Azure NAT Gateway.</a>
        

        
        </li><li>
        <a href="#wil-je-nu-al-zorgen-voor-een-uniforme-aanpak-pak-dan-meteen-de-standaard-internettoegang-in-bestaande-vnets-aan">Wil je nu al zorgen voor een uniforme aanpak? Pak dan meteen de standaard internettoegang in bestaande VNets aan.</a>
        </li></ul>
    </li></ul>
  </details>

    <p><img src="/Images/Outbound/Outbound.Jpeg" alt="alt"></p>
<h1 id="default-outbound-internet-access-wordt-uitgeschakeld">Default Outbound Internet Access wordt uitgeschakeld</h1>
<h3 id="-disclaimer-work-in-progress-">==&gt; Disclaimer work in progress. &lt;==</h3>
<h2 id="voorwoord">Voorwoord</h2>
<p>Tot nu toe gaf Microsoft standaard outbound internettoegang aan elk nieuw Virtual Network.
Dat gebeurde automatisch via een default route naar het internet, zonder dat je daar iets voor hoefde te doen.
Deze standaardinstelling gaf automatisch internettoegang zonder dat je dit expliciet hoefde te configureren.
Dat leek handig, maar het bracht risico‚Äôs met zich mee: ongecontroleerd verkeer, moeilijk te monitoren, en kwetsbaar voor datalekken.
Securityteams hadden minder grip op outbound flows, wat niet paste binnen Zero Trust principes.
Vanaf nu moet je zelf expliciet outbound access regelen via NAT Gateway of andere oplossingen.</p>
<p><img src="/Images/Outbound/network.jpeg" alt="alt">
<ins>Wat Zijn de gevolgen?</ins></p>
<p>Tot nu toe gaf Azure je automatisch internettoegang als je een nieuw Virtual Network aanmaakte.
Handig, toch? Je hoefde niks extra‚Äôs te doen‚Äîje VM kon gewoon het internet op.
Maar vanaf 30 september is dat verleden tijd. Microsoft zet deze automatische toegang uit.</p>
<p><ins>Wat merk jij ervan?</ins></p>
<ul>
<li>Nieuwe Virtual Networks hebben geen automatische internettoegang meer.</li>
<li>Applicaties die afhankelijk zijn van outbound internet moeten expliciet worden geconfigureerd.</li>
<li>Je moet zelf een NAT Gateway of andere outbound oplossing instellen.</li>
<li>Deployment scripts en templates kunnen falen als ze uitgaan van standaard internettoegang.</li>
<li>Monitoring en logging worden belangrijker om outbound verkeer te beheren.</li>
<li>Security wordt strakker: geen ongecontroleerde verbindingen meer.</li>
<li>Je krijgt meer controle, maar ook meer verantwoordelijkheid.</li>
<li>Kosten kunnen stijgen door het gebruik van NAT Gateways.</li>
<li>Legacy-architecturen moeten mogelijk worden aangepast.</li>
<li>Het dwingt teams om bewuster om te gaan met netwerkbeveiliging en outbound flows.</li>
</ul>
<p><strong>Voor bestaande Vnet&rsquo;s veranderd er op dit moment nog niks</strong></p>
<h2 id="welke-oplossingen-zijn-er-om-dit-dan-goed-te-regelen">Welke oplossingen zijn er om dit dan goed te regelen.</h2>
<p><img src="/Images/Outbound/optie.jpeg" alt="alt"></p>
<p><strong>Azure NAT Gateway</strong></p>
<p>Dit is de aanbovolen oplossing voor de meeste omgevingen door Microsoft waarom:</p>
<p><em>Verbeterde Security</em></p>
<p>NAT Gateway biedt gecontroleerde outbound internettoegang, waardoor je precies kunt bepalen welke resources toegang hebben tot het internet. Dit sluit ongecontroleerde verbindingen uit en past beter bij Zero Trust principes.</p>
<p><em>Logging en Monitoring</em></p>
<p>Met NAT Gateway kun je outbound verkeer beter monitoren en loggen. Dit maakt het eenvoudiger om verdachte activiteiten te detecteren en te auditen.</p>
<p><em>Schaalbaarheid</em></p>
<p>NAT Gateway is ontworpen voor hoge schaalbaarheid en ondersteunt duizenden gelijktijdige verbindingen, wat essentieel is voor grote workloads.</p>
<p><em>Statische IP-adressen</em></p>
<p>Je kunt √©√©n of meerdere statische publieke IP-adressen toewijzen aan je outbound verkeer, waardoor je eenvoudiger firewallregels en toegangsbeleid kunt beheren.</p>
<p><em>Kostenbeheer</em></p>
<p>NAT Gateway maakt het mogelijk om outbound verkeer te centraliseren, waardoor je kosten kunt optimaliseren en onverwachte uitgaven door ongecontroleerde outbound flows voorkomt.</p>
<p><strong>Azure Load Balancer (Outbound Rules)</strong></p>
<p>Azure Load Balancer kan ook worden gebruikt om outbound internettoegang te regelen, vooral in scenario‚Äôs waar je al een Load Balancer gebruikt voor inbound verkeer. Waarom is dit een goede vervanging?</p>
<p><em>Flexibele Outbound Configuratie</em></p>
<p>Met outbound rules kun je precies bepalen welke resources outbound internettoegang krijgen, en hoe het verkeer wordt afgehandeld.</p>
<p><em>Statische IP-adressen</em></p>
<p>Je kunt publieke IP-adressen koppelen aan je outbound verkeer, zodat je altijd weet vanaf welk IP je resources het internet op gaan.</p>
<p><em>Schaalbaarheid</em></p>
<p>Azure Load Balancer ondersteunt grote aantallen gelijktijdige verbindingen en is geschikt voor zowel kleine als grote workloads.</p>
<p><em>Integratie met bestaande infrastructuur</em></p>
<p>Als je al een Load Balancer gebruikt voor inbound verkeer, kun je eenvoudig outbound access toevoegen zonder extra componenten.</p>
<p><em>Kostenbesparing</em></p>
<p>Voor sommige scenario‚Äôs kan Load Balancer goedkoper zijn dan NAT Gateway, vooral bij kleinere workloads of als je al een Load Balancer hebt draaien.</p>
<p><strong>Azure Firewall</strong></p>
<p>Azure Firewall is een geavanceerde oplossing voor outbound internettoegang, vooral geschikt voor omgevingen waar security en compliance centraal staan. Waarom is dit een goede vervanging?</p>
<p><em>Geavanceerde Security</em></p>
<p>Azure Firewall biedt diepgaande inspectie van outbound verkeer, inclusief filtering op applicatie- en netwerklaag. Je kunt strikte regels instellen voor toegestane en geblokkeerde verbindingen.</p>
<p><em>Logging, Monitoring en Threat Intelligence</em></p>
<p>Firewall logs zijn zeer gedetailleerd en kunnen worden ge√Øntegreerd met Azure Monitor en Sentinel. Je krijgt inzicht in alle outbound flows en kunt dreigingen snel detecteren.</p>
<p><em>Schaalbaarheid</em></p>
<p>Azure Firewall schaalt automatisch mee met je workload en ondersteunt grote aantallen gelijktijdige verbindingen.</p>
<p><em>Statische en meerdere publieke IP-adressen</em></p>
<p>Je kunt √©√©n of meerdere publieke IP-adressen toewijzen aan outbound verkeer, wat handig is voor toegangsbeheer en compliance.</p>
<p><em>Centralisatie en segmentatie</em></p>
<p>Met Azure Firewall kun je outbound access centraal beheren voor meerdere subnetten en vnets, en segmentatie toepassen voor extra security.
Het minpunt van Azure Firewall is dat het relatief gezien een vrij dure oplossing is.</p>
<p><strong>Public IP op de VM</strong></p>
<p>Het toewijzen van een Public IP-adres direct aan een VM is een eenvoudige manier om outbound internettoegang te regelen. Waarom kan dit een alternatief zijn?</p>
<p><em>Directe internettoegang</em></p>
<p>De VM heeft direct toegang tot het internet zonder tussenliggende componenten, wat configuratie eenvoudig maakt.</p>
<p><em>Statisch IP-adres</em></p>
<p>Je kunt een statisch Public IP-adres toewijzen, zodat je altijd weet vanaf welk IP je VM het internet op gaat.</p>
<p><em>Eenvoudige troubleshooting</em></p>
<p>Problemen met outbound verkeer zijn makkelijker te traceren omdat het verkeer direct vanaf de VM komt.</p>
<p><em>Geen extra kosten voor NAT of Load Balancer</em></p>
<p>Je betaalt alleen voor het Public IP-adres, niet voor extra netwerkcomponenten.</p>
<p><em>Geschikt voor kleine workloads</em></p>
<p>Voor test- of ontwikkelomgevingen kan dit een snelle en goedkope oplossing zijn.</p>
<p>Let op: deze optie is minder veilig en minder schaalbaar dan NAT Gateway, Load Balancer of Firewall. Gebruik dit alleen als security geen grote rol speelt.</p>
<h2 id="hoe-kunen-we-checken-welke-machines-afhankelijk-zijn-van-outbound-access">Hoe kunen we checken welke machines afhankelijk zijn van Outbound access</h2>
<p>Het is belangrijk om te weten welke virtuele machines in je omgeving afhankelijk zijn van outbound internettoegang, zodat je tijdig maatregelen kunt nemen. Wij gebruiken hiervoor Powershell. Met PowerShell kun je bijvoorbeeld opvragen welke VM‚Äôs een public IP-adres hebben. Door deze informatie te verzamelen, kun je gericht bepalen welke workloads extra aandacht nodig hebben bij het uitfaseren van default outbound access.<br>
Voer onderstaande Powershell script uit om een output te krijgen van de servers die je moet aanpassen.</p>
<pre tabindex="0"><code># Login to Azure
Connect-AzAccount

# Select subscription
$subscriptionId = &#34;&lt;your-subscription-id&gt;&#34;
Select-AzSubscription -SubscriptionId $subscriptionId

# Resultaat array
$results = @()

# Get all VMs
$vms = Get-AzVM

foreach ($vm in $vms) {
    $vmName = $vm.Name
    $rgName = $vm.ResourceGroupName
    $hasPublicIp = $false
    $hasOutboundNSG = $false
    $hasInternetRoute = $false

    # Get NIC
    $nicId = $vm.NetworkProfile.NetworkInterfaces[0].Id
    $nicName = ($nicId -split &#34;/&#34;)[-1]
    $nic = Get-AzNetworkInterface -Name $nicName -ResourceGroupName $rgName

    # Check for public IP
    foreach ($ipConfig in $nic.IpConfigurations) {
        if ($ipConfig.PublicIpAddress) {
            $hasPublicIp = $true
            $publicIpName = ($ipConfig.PublicIpAddress.Id -split &#34;/&#34;)[-1]
            $publicIpRg = ($ipConfig.PublicIpAddress.Id -split &#34;/&#34;)[4]
            $publicIp = Get-AzPublicIpAddress -Name $publicIpName -ResourceGroupName $publicIpRg
        }
    }


    # Check NSG outbound rules
    if ($nic.NetworkSecurityGroup) {
        $nsgName = ($nic.NetworkSecurityGroup.Id -split &#34;/&#34;)[-1]
        $nsgRg = ($nic.NetworkSecurityGroup.Id -split &#34;/&#34;)[4]
        $nsg = Get-AzNetworkSecurityGroup -Name $nsgName -ResourceGroupName $nsgRg
        $outboundRules = $nsg.SecurityRules | Where-Object { $_.Direction -eq &#34;Outbound&#34; -and $_.Access -eq &#34;Allow&#34; }
        if ($outboundRules.Count -gt 0) {
            $hasOutboundNSG = $true
        }
    }


    # Check route table
    $subnetId = $nic.IpConfigurations[0].Subnet.Id
    $vnetRg = ($subnetId -split &#34;/&#34;)[4]
    $vnetName = ($subnetId -split &#34;/&#34;)[8]
    $vnet = Get-AzVirtualNetwork -Name $vnetName -ResourceGroupName $vnetRg
    $subnetName = ($subnetId -split &#34;/&#34;)[-1]
    $subnet = $vnet.Subnets | Where-Object { $_.Name -eq $subnetName }

    if ($subnet.RouteTable) {
        $routeTable = Get-AzRouteTable -ResourceId $subnet.RouteTable.Id
        $internetRoute = $routeTable.Routes | Where-Object { $_.AddressPrefix -eq &#34;0.0.0.0/0&#34; -and $_.NextHopType -eq &#34;Internet&#34; }
        if ($internetRoute) {
            $hasInternetRoute = $true
        }
    }

    # Output to console
    Write-Host &#34;VM: $vmName&#34;
    Write-Host &#34;  ‚úÖ Public IP: $hasPublicIp&#34;
    Write-Host &#34;  üîÑ NSG Outbound Access: $hasOutboundNSG&#34;
    Write-Host &#34;  üåê Internet Route: $hasInternetRoute&#34;
    Write-Host &#34;---------------------------------------------&#34;

    # Add to results
    $results += [PSCustomObject]@{
        VMName           = $vmName
        ResourceGroup    = $rgName
        PublicIP         = $hasPublicIp
        NSGOutboundAllow = $hasOutboundNSG
        InternetRoute    = $hasInternetRoute
    }
}

# Export to CSV
$results | Export-Csv -Path &#34;OutboundAccessReport.csv&#34; -NoTypeInformation
Write-Host &#34;‚úÖ Rapport opgeslagen als &#39;OutboundAccessReport.csv&#39;&#34;
</code></pre><p>We hebben nu onderzocht welke machines een Public IP hebben,NSG Rules hebben of een Internet Route.
Nu moeten we de gekozen optie implementeren. Het aanmaken van een Azure Firewall zullen we later nog eens bespreken,
Public IP toevoegen spreekt voor zich, dus we gaan nu het aanmaken van een Azure NAT Gateway aanmaken.</p>
<h2 id="aanmaken-van-een-azure-nat-gateway">Aanmaken van een Azure NAT Gateway.</h2>
<p><img src="/Images/Outbound/Nat.png" alt="Image"></p>
<p>Azure NAT Gateway is de aanbevolen oplossing om veilige en schaalbare outbound internettoegang te bieden voor je virtuele machines en andere resources in Azure. Met NAT Gateway kun je outbound verkeer centraliseren en beheren, zodat je precies weet welke IP-adressen worden gebruikt voor internettoegang. Dit maakt het eenvoudiger om firewallregels toe te passen, monitoring in te richten en je netwerkarchitectuur te beveiligen. Daarnaast zorgt NAT Gateway voor hoge beschikbaarheid en ondersteunt het duizenden gelijktijdige verbindingen, waardoor het geschikt is voor zowel kleine als grote omgevingen. Hieronder lees je hoe je een NAT Gateway aanmaakt en configureert.
Maar hoe configureer je dit nu:</p>
<p>Log in op de Azure portal en klik op <strong>Create a resource</strong>.</p>
<p><img src="/Images/Outbound/NatGateway.png" alt="Image"></p>
<p>Vul in <strong>NAT Gateway</strong> en klik op <strong>Create</strong>.</p>
<p>Vul in en klik op <strong>Next</strong></p>
<pre tabindex="0"><code>Subscription = Subscription waar connectivity aan verbonden is
Resource Group = RG voor Connectivity

NAT Gateway Name = Naam
Region = Regio waar jullie alles op deployen. (West Europe in dit geval)
Availability Zone = Geef aan of je dit wilt gebruiken in geval van issues in het datacenter
TCP Ide timeout = Tijd tussen 4 en 120 minuten voordat er een timeout optreed en de connectie word gesloten.
</code></pre><p><img src="/Images/Outbound/NatGateway1.png" alt="Image"></p>
<p>Nu moeten we de outbound adressen gaan configureren.</p>
<p>Klik eerst op <strong>Create a new public IP address</strong></p>
<pre tabindex="0"><code>Name = naam voor de publieke IP.
SKU = Basic
Assignment = Static
</code></pre><p>Klik op <strong>Ok</strong></p>
<p><img src="/Images/Outbound/pip.png" alt="Image">
Vervolgens configureren we de Prefix. (dus hoeveel Public IP&rsquo;s kunnen er maximaal in deze NAT Gateway nog aangemaakt worden.)</p>
<p>Klik  op <strong>Create a new public IP prefix</strong></p>
<pre tabindex="0"><code>Name = naam voor de publieke prefix.
Prefix Size= Pak de grootte die je nodig hebt. In deze test pak ik een /31 omdat ik niet meer als 2 externe adressen nodig heb.
</code></pre><p>Klik op <strong>Ok</strong></p>
<p><img src="/Images/Outbound/pip2.png" alt="Image"></p>
<p>klik op <strong>Next</strong></p>
<p>We zijn nu aangekomen bij het configureren van de subnets die deze NAT gaan gebruiken.
Dus selecteer het Virtual network en daarna de subnets.</p>
<p><img src="/Images/Outbound/NAT1.png" alt="Image"></p>
<p>klik op <strong>Review+Create</strong> en daarna op <strong>Create</strong></p>
<p><img src="/Images/Outbound/passed.png" alt="Image"></p>
<p>We kunnen dit ook opbouwen via Powershell dat doe je via onderstaande Powershell script.</p>
<pre tabindex="0"><code># Set the variables for the NAT Gateway.
$rg = &#34;RG-Andy-Test2&#34;
$Location = &#34;Westeurope&#34;
$sku = &#34;Standard&#34;
$PublicIpname = &#34;pip&#34;
$Publicprefixname = &#34;PIPPrefix&#34;
$NatGatewayname=&#34;NATGateway&#34;


#create Rsource group
New-AzResourceGroup -Name $rg -Location $Location 

#create Standard SKUP public IP
$publicIP = New-AzPublicIpAddress -Name $PublicIpname -ResourceGroupName $rg -AllocationMethod Static -Location $Location -Sku $sku

#create  IP prefix
$publicIPPrefix = New-AzPublicIpPrefix -Name $Publicprefixname -ResourceGroupName $rg -Location $Location -PrefixLength 29

#Create NAT gateway
$natGateway = New-AzNatGateway -Name $NatGatewayname -ResourceGroupName $rg -PublicIpAddress $publicIP -PublicIpPrefix $publicIPPrefix -Location $Location -Sku $sku -IdleTimeoutInMinutes 4
$natGateway  | Select-Object Name, ResourceGroupName, IdleTimeoutInMinutes , SKuText | Format-table -autosize ‚Äìwrap

$virtualNetwork = Get-AzVirtualNetwork | Out-GridView -PassThru -Title &#34;Kies je VNET&#34;
$NATSubnet = Get-AzVirtualNetworkSubnetConfig -VirtualNetwork $virtualNetwork | Out-GridView -PassThru -Title &#34;Kies de Subnets&#34;
</code></pre><p>Nu is de NAT Gateway gedeployed en geconfigureerd het enige wat nu nog moet gebeuren, is inloggen op de VM en testen of outbound verkeer werkt.</p>
<h2 id="wil-je-nu-al-zorgen-voor-een-uniforme-aanpak-pak-dan-meteen-de-standaard-internettoegang-in-bestaande-vnets-aan">Wil je nu al zorgen voor een uniforme aanpak? Pak dan meteen de standaard internettoegang in bestaande VNets aan.</h2>
<p>Dat doe je zo:</p>
<p>üîí <em>Blokkeer ongewenst internetverkeer</em>
Maak een outbound NSG-regel die al het verkeer naar het internet tegenhoudt ‚Äî behalve via jouw gekozen route.</p>
<p>üöß <em>Stuur het verkeer bewust de juiste kant op</em>
Koppel expliciet een NAT Gateway of Firewall aan je VNet en zorg dat andere routes verdwijnen uit het plaatje.</p>
<p>Zo houd je de touwtjes stevig in handen en voorkom je dat verkeer stiekem via de achterdeur naar buiten glipt.</p>

<div class="px-2 mb-2">
  
  <script src="https://giscus.app/client.js"
    data-repo=""
    data-repo-id=""
    data-category=""
    data-category-id=""
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="preferred_color_scheme"
    data-lang="en"
    crossorigin="anonymous"
    async>
  </script>
  
</div>
</article><div class="bg-blue-100 dark:bg-gray-900">
  <div class="container px-4 py-12 mx-auto max-w-4xl grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
    <div>
      <div class="text-2xl font-bold mb-2">Wil je me volgen op Linkedin, Github of Youtube?</div>
      <p class="opacity-60"></p>
      
      
      
      
      
      
      
      
      
    </div>

    <ul class="flex justify-center gap-x-3 flex-wrap gap-y-2">
      

      

      

      
      <li>
        <a
          href="https://www.linkedin.com/in/andy-clifton-4b497bb6/"
          target="_blank"
          rel="noopener"
          aria-label="LinkedIn"
          class="p-1 inline-block rounded-full border border-transparent text-gray-500 hover:text-gray-800 hover:border-gray-800 cursor-pointer transition-colors dark:text-gray-600 dark:hover:border-gray-300 dark:hover:text-gray-300"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <rect x="4" y="4" width="16" height="16" rx="2" />
            <line x1="8" y1="11" x2="8" y2="16" />
            <line x1="8" y1="8" x2="8" y2="8.01" />
            <line x1="12" y1="16" x2="12" y2="11" />
            <path d="M16 16v-3a2 2 0 0 0 -4 0" />
          </svg>
        </a>
      </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      



      

      

      

      

      
      <li>
        <a
          href="https://github.com/AndyClifton2"
          target="_blank"
          rel="noopener"
          aria-label="GitHub"
          class="p-1 inline-block rounded-full border border-transparent text-gray-500 hover:text-gray-800 hover:border-gray-800 cursor-pointer transition-colors dark:text-gray-600 dark:hover:border-gray-300 dark:hover:text-gray-300"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path
              d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"
            />
          </svg>
        </a>
      </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      



      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      



      

      

      

      

      

      

      

      

      

      

      
      <li>
        <a
          href="https://www.youtube.com/@AzureAdventurer"
          target="_blank"
          rel="noopener"
          aria-label="YouTube"
          class="p-1 inline-block rounded-full border border-transparent text-gray-500 hover:text-gray-800 hover:border-gray-800 cursor-pointer transition-colors dark:text-gray-600 dark:hover:border-gray-300 dark:hover:text-gray-300"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="icon icon-tabler icon-tabler-brand-youtube"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <circle cx="12" cy="12" r="9" />
            <path d="M10 9l5 3l-5 3z" />
          </svg>
        </a>
      </li>
      

      

      

      

      

      

      

      

      


    </ul>
  </div>
</div>

    </main><footer class="container p-6 mx-auto flex justify-between items-center">
  <span class="text-sm font-light">
    
    Copyright ¬© 2024 - Andy Clifton ¬∑ All rights reserved
    
  </span>
  <span onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="p-1 cursor-pointer">
    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" stroke-width="1.5"
      stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M18 15l-6 -6l-6 6h12" />
    </svg>
  </span>
</footer>

<div class="search-ui absolute top-0 left-0 w-full h-full bg-white dark:bg-gray-800 hidden">
  <div class="container max-w-3xl mx-auto p-12">
    <div class="relative">
      <div class="my-4 text-center text-2xl font-bold">Search</div>

      <span class="p-2 absolute right-0 top-0 cursor-pointer close-search">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </span>
    </div>

    <input type="search" class="py-2 px-3 w-full dark:text-black border dark:border-transparent"
      placeholder="Enter search query" />

    <div class="search-results text-lg font-medium my-4 hidden">Results</div>
    <ul class="search-list my-2">

    </ul>

    <div class="no-results text-center my-8 hidden">
      <div class="text-xl font-semibold mb-2">No results found</div>
      <p class="font-light text-sm">Try adjusting your search query</p>
    </div>
  </div>
</div>





<script src="/js/scripts.min.js"></script>







<script>
  
  const darkmode = document.querySelector('.toggle-dark-mode');
  function toggleDarkMode() {
    if (document.documentElement.classList.contains('dark')) {
      document.documentElement.classList.remove('dark')
      localStorage.setItem('darkmode', 'light')
    } else {
      document.documentElement.classList.add('dark')
      localStorage.setItem('darkmode', 'dark')
    }
  }
  if (darkmode) {
    darkmode.addEventListener('click', toggleDarkMode);
  }

  const darkStorage = localStorage.getItem('darkmode');
  const isBrowserDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

  if (!darkStorage && isBrowserDark) {
    document.documentElement.classList.add('dark');
  }

  if (darkStorage && darkStorage === 'dark') {
    toggleDarkMode();
  }
</script>


<script>
  const mobileMenuButton = document.querySelector('.mobile-menu-button')
  const mobileMenu = document.querySelector('.mobile-menu')
  function toggleMenu() {
    mobileMenu.classList.toggle('hidden');
    mobileMenu.classList.toggle('flex');
  }
  if(mobileMenu && mobileMenuButton){
    mobileMenuButton.addEventListener('click', toggleMenu)
  }
</script>
</body>
</html>
